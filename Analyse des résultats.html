<!DOCTYPE html>
<html lang="fr">
<head> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire d'Évaluation - Enseignants</title>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2c3e50;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --light: #ecf0f1;
            --dark: #34495e;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .description {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            padding: 20px;
        }
        
        .config-panel {
            flex: 1;
            min-width: 300px;
            padding: 20px;
            background: var(--light);
            border-radius: 8px;
            margin-right: 20px;
        }
        
        .form-container {
            flex: 3;
            min-width: 500px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .btn {
            padding: 12px 25px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        .btn-success {
            background-color: var(--success);
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-danger {
            background-color: var(--danger);
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .student-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
            transition: all 0.3s;
        }
        
        .student-row:hover {
            background: #edf7ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }
        
        .student-name {
            flex: 1;
            min-width: 200px;
        }
        
        .student-note {
            flex: 0 0 100px;
        }
        
        .student-actions {
            flex: 0 0 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .student-points {
            flex: 1;
            min-width: 300px;
        }
        
        .actions {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding: 20px;
            background: var(--light);
            border-radius: 8px;
        }
        
        .alert {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            display: none;
        }
        
        .alert-success {
            background-color: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #a5d6a7;
        }
        
        .alert-danger {
            background-color: #ffebee;
            color: #c62828;
            border: 1px solid #ef9a9a;
        }
        
        .json-output {
            margin-top: 30px;
            padding: 20px;
            background: #2c3e50;
            color: white;
            border-radius: 8px;
            display: none;
        }
        
        pre {
            white-space: pre-wrap;
            word-break: break-all;
            font-family: 'Courier New', monospace;
            background: #34495e;
            padding: 15px;
            border-radius: 4px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .download-btn {
            margin-top: 15px;
        }
        
        .btn-retour {
            padding: 8px 16px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-bottom: 20px;
        }
        
        .btn-retour:hover {
            background-color: #e0e0e0;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .config-panel {
                margin-right: 0;
                margin-bottom: 20px;
            }
            
            .student-row {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <button class="btn-retour" onclick="history.back()">← Retour</button>
    
    <div class="container">
        <header>
            <h1>Formulaire d'Évaluation des Élèves</h1>
            <p class="description">Saisissez les notes et appréciations pour générer un fichier JSON d'analyse</p>
        </header>
        
        <div class="alert alert-success" id="successAlert"></div>
        <div class="alert alert-danger" id="errorAlert"></div>
        
        <div class="main-content">
            <div class="config-panel">
                <h2>Configuration</h2>
                <div class="form-group">
                    <label for="classe">Classe</label>
                    <select id="classe" required onchange="loadStudents()">
                        <option value="">Sélectionnez une classe</option>
                        <option value="6ème A">6ème A</option>
                        <option value="6ème B">6ème B</option>
                        <option value="5ème A">5ème A</option>
                        <option value="5ème B">5ème B</option>
                        <option value="4ème A">4ème A</option>
                        <option value="4ème B">4ème B</option>
                        <option value="3ème A">3ème A</option>
                        <option value="3ème B">3ème B</option>
                        <option value="2nde A">2nde A</option>
                        <option value="2nde B">2nde B</option>
                        <option value="1ère S">1ère S</option>
                        <option value="1ère ES">1ère ES</option>
                        <option value="1ère L">1ère L</option>
                        <option value="Terminale S">Terminale S</option>
                        <option value="Terminale ES">Terminale ES</option>
                        <option value="Terminale L">Terminale L</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="matiere">Matière</label>
                    <select id="matiere" required>
                        <option value="">Sélectionnez une matière</option>
                        <option value="Mathématiques">Mathématiques</option>
                        <option value="Français">Français</option>
                        <option value="Histoire-Géographie">Histoire-Géographie</option>
                        <option value="SVT">SVT</option>
                        <option value="Physique-Chimie">Physique-Chimie</option>
                        <option value="Anglais">Anglais</option>
                        <option value="Espagnol">Espagnol</option>
                        <option value="Allemand">Allemand</option>
                        <option value="Philosophie">Philosophie</option>
                        <option value="Éducation Physique et Sportive">Éducation Physique et Sportive</option>
                        <option value="Technologie">Technologie</option>
                        <option value="Sciences Économiques et Sociales">Sciences Économiques et Sociales</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="enseignant">Enseignant</label>
                    <input type="text" id="enseignant" placeholder="Votre nom" required>
                </div>
                
                <div class="form-group">
                    <label for="date">Date de l'évaluation</label>
                    <input type="date" id="date" required>
                </div>
                
                <div class="form-group">
                    <label for="type">Type d'évaluation</label>
                    <select id="type">
                        <option value="Contrôle">Contrôle</option>
                        <option value="Devoir maison">Devoir maison</option>
                        <option value="Interrogation">Interrogation</option>
                        <option value="Examen">Examen</option>
                        <option value="Projet">Projet</option>
                        <option value="Oral">Oral</option>
                    </select>
                </div>
                
                <button class="btn" id="addStudent">
                    <i>+</i> Ajouter un élève manuellement
                </button>
            </div>
            
            <div class="form-container">
                <h2>Évaluations des élèves</h2>
                <div id="studentsContainer">
                    <!-- Les lignes des élèves seront ajoutées ici dynamiquement -->
                </div>
            </div>
        </div>
        
        <div class="actions">
            <button class="btn btn-danger" id="resetForm">
                <i>↺</i> Réinitialiser
            </button>
            
            <button class="btn btn-success" id="generateJson">
                <i>{"}"}</i> Générer le JSON
            </button>
        </div>
        
        <div class="json-output" id="jsonOutput">
            <h2>Fichier JSON généré</h2>
            <pre id="jsonContent"></pre>
            <button class="btn download-btn" id="downloadJson">
                <i>⭳</i> Télécharger le fichier JSON
            </button>
        </div>
    </div>

    <script>
        // Base de données des élèves par classe
        const studentsDatabase = {
            "6ème A": [
                "Martin Dupont", "Léa Martin", "Hugo Bernard", "Emma Petit", 
                "Lucas Moreau", "Chloé Durand", "Thomas Dubois", "Manon Richard"
            ],
            "6ème B": [
                "Jules Laurent", "Inès Michel", "Noé Garcia", "Sarah Robert", 
                "Maxime Leroy", "Lola Roux", "Adam Fournier", "Zoé Morel"
            ],
            "5ème A": [
                "Raphaël Girard", "Louise Blanc", "Victor François", "Julie Gérard", 
                "Nathan Lefebvre", "Camille Lopez", "Alexandre Sanchez", "Éva Perez"
            ],
            "5ème B": [
                "Mathis Nguyen", "Clara Muller", "Tom Weber", "Léa Klein", 
                "Enzo Schmidt", "Jade Fischer", "Théo Becker", "Maëlys Hoffmann"
            ],
            "4ème A": [
                "Antoine Meyer", "Léna Wagner", "Baptiste Schneider", "Océane Richter", 
                "Romain Schulz", "Émilie Neumann", "Quentin Braun", "Lilou Hofmann"
            ],
            "4ème B": [
                "Sacha Zimmermann", "Romane Hartmann", "Gabin Krüger", "Louna Werner", 
                "Nolan Lange", "Alicia Schmitz", "Eliott Köhler", "Lana Bauer"
            ],
            "3ème A": [
                "Timothé Günther", "Lina Huber", "Mathias Walter", "Charlie Fuchs", 
                "Raphaël Peters", "Léonie Vogel", "Noam Engel", "Élise Hahn"
            ],
            "3ème B": [
                "Kylian Schubert", "Mya Roth", "Léonard Brandt", "Lily Wolf", 
                "Aaron Sommer", "Nina Schröder", "Marceau Friedrich", "Eva Zimmermann"
            ],
            "2nde A": [
                "Bryan Schwarz", "Lana Koch", "Rayan Böhm", "Léane Schäfer", 
                "Matteo Berger", "Lyna Schröder", "Nino Ziegler", "Lilwenn Kuhn"
            ],
            "2nde B": [
                "Ethan Frank", "Lana Keller", "Samuel Günther", "Lilou Becker", 
                "Mathis Wagner", "Léna Bauer", "Tom Hartmann", "Lina Richter"
            ],
            "1ère S": [
                "Alexandre Schuster", "Louna Vogel", "Maxence Winkler", "Lilou Haas", 
                "Théophile Otto", "Léa Schmid", "Raphaël Lang", "Lyna Koch"
            ],
            "1ère ES": [
                "Mathias Engel", "Léane Brandt", "Noam Pfeiffer", "Lina Wolf", 
                "Kylian Horn", "Lilwenn Busch", "Marceau Ziegler", "Lyna Thomas"
            ],
            "1ère L": [
                "Léonard Sommer", "Lily Kuhn", "Aaron Frank", "Léa Keller", 
                "Rayan Günther", "Léna Becker", "Nino Wagner", "Lina Bauer"
            ],
            "Terminale S": [
                "Matteo Hartmann", "Lyna Richter", "Bryan Schwarz", "Lana Koch", 
                "Raphaël Böhm", "Léane Schäfer", "Tom Berger", "Lilou Schröder"
            ],
            "Terminale ES": [
                "Ethan Ziegler", "Lilwenn Kuhn", "Samuel Frank", "Léa Keller", 
                "Mathis Günther", "Léna Becker", "Noam Wagner", "Lina Bauer"
            ],
            "Terminale L": [
                "Théophile Hartmann", "Louna Richter", "Maxence Schwarz", "Lilou Koch", 
                "Raphaël Böhm", "Lyna Schäfer", "Alexandre Berger", "Léane Schröder"
            ]
        };

        document.addEventListener('DOMContentLoaded', function() {
            // Initialiser la date du jour
            document.getElementById('date').valueAsDate = new Date();
            
            // Références aux éléments DOM
            const addStudentBtn = document.getElementById('addStudent');
            const resetFormBtn = document.getElementById('resetForm');
            const generateJsonBtn = document.getElementById('generateJson');
            const downloadJsonBtn = document.getElementById('downloadJson');
            const studentsContainer = document.getElementById('studentsContainer');
            const jsonOutput = document.getElementById('jsonOutput');
            const jsonContent = document.getElementById('jsonContent');
            const successAlert = document.getElementById('successAlert');
            const errorAlert = document.getElementById('errorAlert');
            const classeSelect = document.getElementById('classe');
            
            // Compteur pour les IDs des élèves
            let studentId = 1;
            
            // Événements
            addStudentBtn.addEventListener('click', addStudentRow);
            resetFormBtn.addEventListener('click', resetForm);
            generateJsonBtn.addEventListener('click', generateJson);
            downloadJsonBtn.addEventListener('click', downloadJson);
            
            // Fonction pour charger les élèves en fonction de la classe sélectionnée
            window.loadStudents = function() {
                const selectedClass = classeSelect.value;
                if (selectedClass && studentsDatabase[selectedClass]) {
                    // Vider le conteneur d'élèves
                    studentsContainer.innerHTML = '';
                    studentId = 1;
                    
                    // Ajouter chaque élève de la classe
                    studentsDatabase[selectedClass].forEach(studentName => {
                        addStudentRowWithName(studentName);
                    });
                    
                    showSuccess(`Liste des élèves de ${selectedClass} chargée avec succès!`);
                }
            }
            
            // Fonction pour ajouter une ligne d'élève avec un nom prédéfini
            function addStudentRowWithName(name) {
                const row = document.createElement('div');
                row.className = 'student-row';
                row.id = `student-${studentId}`;
                
                row.innerHTML = `
                    <div class="student-name">
                        <label for="name-${studentId}">Nom de l'élève</label>
                        <input type="text" id="name-${studentId}" class="student-name-input" value="${name}" required>
                    </div>
                    
                    <div class="student-note">
                        <label for="note-${studentId}">Note /20</label>
                        <input type="number" id="note-${studentId}" class="student-note-input" min="0" max="20" step="0.5" required>
                    </div>
                    
                    <div class="student-points">
                        <label for="points-forts-${studentId}">Points forts (séparés par des virgules)</label>
                        <textarea id="points-forts-${studentId}" class="student-points-forts-input" placeholder="Ex: Calcul mental, Résolution de problèmes"></textarea>
                    </div>
                    
                    <div class="student-points">
                        <label for="points-faibles-${studentId}">Points faibles (séparés par des virgules)</label>
                        <textarea id="points-faibles-${studentId}" class="student-points-faibles-input" placeholder="Ex: Géométrie, Rédaction"></textarea>
                    </div>
                    
                    <div class="student-actions">
                        <button class="btn btn-danger" onclick="removeStudent(${studentId})">
                            <i>×</i>
                        </button>
                    </div>
                `;
                
                studentsContainer.appendChild(row);
                studentId++;
            }
            
            // Fonction pour ajouter une ligne d'élève vide
            function addStudentRow() {
                const row = document.createElement('div');
                row.className = 'student-row';
                row.id = `student-${studentId}`;
                
                row.innerHTML = `
                    <div class="student-name">
                        <label for="name-${studentId}">Nom de l'élève</label>
                        <input type="text" id="name-${studentId}" class="student-name-input" placeholder="Nom et prénom" required>
                    </div>
                    
                    <div class="student-note">
                        <label for="note-${studentId}">Note /20</label>
                        <input type="number" id="note-${studentId}" class="student-note-input" min="0" max="20" step="0.5" required>
                    </div>
                    
                    <div class="student-points">
                        <label for="points-forts-${studentId}">Points forts (séparés par des virgules)</label>
                        <textarea id="points-forts-${studentId}" class="student-points-forts-input" placeholder="Ex: Calcul mental, Résolution de problèmes"></textarea>
                    </div>
                    
                    <div class="student-points">
                        <label for="points-faibles-${studentId}">Points faibles (séparés par des virgules)</label>
                        <textarea id="points-faibles-${studentId}" class="student-points-faibles-input" placeholder="Ex: Géométrie, Rédaction"></textarea>
                    </div>
                    
                    <div class="student-actions">
                        <button class="btn btn-danger" onclick="removeStudent(${studentId})">
                            <i>×</i>
                        </button>
                    </div>
                `;
                
                studentsContainer.appendChild(row);
                studentId++;
            }
            
            // Fonction pour supprimer une ligne d'élève
            window.removeStudent = function(id) {
                const row = document.getElementById(`student-${id}`);
                if (row) {
                    studentsContainer.removeChild(row);
                }
            }
            
            // Fonction pour réinitialiser le formulaire
            function resetForm() {
                if (confirm('Êtes-vous sûr de vouloir réinitialiser le formulaire? Toutes les données seront perdues.')) {
                    studentsContainer.innerHTML = '';
                    document.getElementById('classe').value = '';
                    document.getElementById('matiere').value = '';
                    document.getElementById('enseignant').value = '';
                    document.getElementById('date').valueAsDate = new Date();
                    document.getElementById('type').value = 'Contrôle';
                    jsonOutput.style.display = 'none';
                    successAlert.style.display = 'none';
                    errorAlert.style.display = 'none';
                    
                    studentId = 1;
                }
            }
            
            // Fonction pour générer le JSON
            function generateJson() {
                // Récupérer les valeurs de configuration
                const classe = document.getElementById('classe').value;
                const matiere = document.getElementById('matiere').value;
                const enseignant = document.getElementById('enseignant').value;
                const date = document.getElementById('date').value;
                const type = document.getElementById('type').value;
                
                // Valider les champs de configuration
                if (!classe || !matiere || !enseignant || !date) {
                    showError('Veuillez remplir tous les champs de configuration.');
                    return;
                }
                
                // Récupérer les données des élèves
                const students = [];
                const studentRows = document.getElementsByClassName('student-row');
                
                for (let i = 0; i < studentRows.length; i++) {
                    const id = studentRows[i].id.split('-')[1];
                    const name = document.getElementById(`name-${id}`).value;
                    const note = document.getElementById(`note-${id}`).value;
                    const pointsForts = document.getElementById(`points-forts-${id}`).value.split(',').map(item => item.trim()).filter(item => item);
                    const pointsFaibles = document.getElementById(`points-faibles-${id}`).value.split(',').map(item => item.trim()).filter(item => item);
                    
                    // Valider les champs de l'élève
                    if (!name || !note) {
                        showError(`Veuillez remplir tous les champs pour l'élève ${i+1}.`);
                        return;
                    }
                    
                    students.push({
                        classe: classe,
                        matiere: matiere,
                        eleve: name,
                        note: parseFloat(note),
                        pointsForts: pointsForts,
                        pointsFaibles: pointsFaibles
                    });
                }
                
                // Créer l'objet JSON
                const jsonData = {
                    meta: {
                        enseignant: enseignant,
                        date: date,
                        type: type
                    },
                    evaluations: students
                };
                
                // Afficher le JSON
                jsonContent.textContent = JSON.stringify(jsonData, null, 2);
                jsonOutput.style.display = 'block';
                
                // Faire défiler jusqu'au JSON
                jsonOutput.scrollIntoView({ behavior: 'smooth' });
                
                showSuccess('Fichier JSON généré avec succès!');
            }
            
            // Fonction pour télécharger le JSON
            function downloadJson() {
                const jsonString = jsonContent.textContent;
                if (!jsonString) {
                    showError('Aucune donnée à télécharger. Veuillez générer le JSON d\'abord.');
                    return;
                }
                
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `evaluations_${document.getElementById('classe').value}_${document.getElementById('matiere').value}_${document.getElementById('date').value}.json`;
                document.body.appendChild(a);
                a.click();
                
                // Nettoyer
                setTimeout(() => {
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 100);
                
                showSuccess('Fichier téléchargé avec succès!');
            }
            
            // Fonctions utilitaires pour afficher les messages
            function showError(message) {
                errorAlert.textContent = message;
                errorAlert.style.display = 'block';
                setTimeout(() => {
                    errorAlert.style.display = 'none';
                }, 5000);
                
                // Faire défiler jusqu'en haut pour voir l'erreur
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
            
            function showSuccess(message) {
                successAlert.textContent = message;
                successAlert.style.display = 'block';
                setTimeout(() => {
                    successAlert.style.display = 'none';
                }, 5000);
            }
        });
    </script>
</body>
</html>
