<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion Scolaire - Togo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }
        
        header {
            background: #006400;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .logo-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            background: #daa520;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #006400;
        }
        
        .school-info {
            text-align: center;
            flex-grow: 1;
            padding: 0 20px;
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }
        
        h2 {
            font-size: 20px;
            color: #006400;
            margin: 20px 0 15px;
            padding-bottom: 5px;
            border-bottom: 2px solid #006400;
        }
        
        h3 {
            font-size: 18px;
            color: #006400;
            margin: 15px 0 10px;
        }
        
        .form-section {
            padding: 20px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -10px 15px;
        }
        
        .form-group {
            flex: 1;
            min-width: 200px;
            padding: 0 10px;
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #006400;
            box-shadow: 0 0 5px rgba(0, 100, 0, 0.3);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        
        th {
            background-color: #f2f2f2;
            font-weight: 600;
        }
        
        .btn {
            background: #006400;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn:hover {
            background: #004d00;
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-sm {
            padding: 8px 15px;
            font-size: 14px;
        }
        
        .btn-success {
            background: #28a745;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-danger {
            background: #dc3545;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .btn-info {
            background: #17a2b8;
        }
        
        .btn-info:hover {
            background: #138496;
        }
        
        .actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            padding: 20px;
            flex-wrap: wrap;
        }
        
        .discipline-row {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 10px;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px dashed #eee;
        }
        
        .discipline-name {
            flex: 2;
            min-width: 150px;
        }
        
        .discipline-field {
            flex: 1;
            min-width: 80px;
            margin: 0 5px;
        }
        
        .remove-btn {
            background: #dc3545;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
        }
        
        .add-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 0;
            font-weight: 600;
        }
        
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        .checkbox-group {
            display: flex;
            gap: 15px;
            margin: 10px 0;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .results-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .result-item {
            padding: 10px;
            background: white;
            border-radius: 5px;
            border-left: 4px solid #006400;
        }
        
        .result-value {
            font-size: 18px;
            font-weight: bold;
            color: #006400;
        }
        
        .student-list {
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .student-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .student-item:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .student-info {
            display: flex;
            gap: 15px;
        }
        
        .student-actions {
            display: flex;
            gap: 10px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close {
            font-size: 24px;
            cursor: pointer;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            color: #666;
            font-size: 14px;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }
        
        .tab.active {
            border-bottom: 3px solid #006400;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .form-group {
                min-width: 100%;
            }
            
            .grid-3, .results-grid {
                grid-template-columns: 1fr;
            }
            
            .discipline-field {
                min-width: 60px;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .student-info {
                flex-direction: column;
                gap: 5px;
            }
            
            .student-actions {
                flex-direction: column;
                gap: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-section">
                <div class="logo">RTT</div>
                <div class="school-info">
                    <h1>RÃ‰PUBLIQUE TOGOLAISE</h1>
                    <p>Travail - LibertÃ© - Patrie</p>
                    <p>MinistÃ¨re des Enseignements Primaire, Secondaire et Technique</p>
                    <p>Inspection de l'Enseignement Secondaire GÃ©nÃ©ral - Kara</p>
                </div>
                <div class="logo">DRE</div>
            </div>
        </header>

        <div class="tabs">
            <div class="tab active" onclick="switchTab(0)">Gestion de la Classe</div>
            <div class="tab" onclick="switchTab(1)">Saisie des Notes</div>
            <div class="tab" onclick="switchTab(2)">RÃ©sultats</div>
        </div>

        <form id="bulletinForm">
            <!-- Onglet 1: Gestion de la classe -->
            <div class="tab-content active">
                <div class="form-section">
                    <h2>Informations de la Classe</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="niveau">Niveau d'enseignement</label>
                            <select id="niveau" required onchange="updateMatieres()">
                                <option value="">SÃ©lectionner un niveau</option>
                                <option value="college">CollÃ¨ge</option>
                                <option value="lycee">LycÃ©e</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="classe">Classe</label>
                            <select id="classe" required onchange="updateMatieres()">
                                <option value="">SÃ©lectionner une classe</option>
                                <option value="6e">6Ã¨me</option>
                                <option value="5e">5Ã¨me</option>
                                <option value="4e">4Ã¨me</option>
                                <option value="3e">3Ã¨me</option>
                                <option value="2nd">Seconde</option>
                                <option value="1ere">PremiÃ¨re</option>
                                <option value="tle">Terminale</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="serie">SÃ©rie (LycÃ©e)</label>
                            <select id="serie" onchange="updateMatieres()">
                                <option value="">SÃ©lectionner une sÃ©rie</option>
                                <option value="A">SÃ©rie A</option>
                                <option value="C">SÃ©rie C</option>
                                <option value="D">SÃ©rie D</option>
                                <option value="E">SÃ©rie E</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="inspection">Inspection de l'Enseignement</label>
                            <input type="text" id="inspection" value="IESG-KARA" readonly>
                        </div>
                        <div class="form-group">
                            <label for="direction">Direction RÃ©gionale</label>
                            <input type="text" id="direction" value="DRE-KARA" readonly>
                        </div>
                        <div class="form-group">
                            <label for="anneeScolaire">AnnÃ©e Scolaire</label>
                            <input type="text" id="anneeScolaire" placeholder="Ex: 2023-2024" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="periode">PÃ©riode</label>
                            <select id="periode" required>
                                <option value="">SÃ©lectionner une pÃ©riode</option>
                                <option value="1">1er Trimestre</option>
                                <option value="2">2Ã¨me Trimestre</option>
                                <option value="3">3Ã¨me Trimestre</option>
                                <option value="4">1er Semestre</option>
                                <option value="5">2Ã¨me Semestre</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="dateEdition">Date d'Ã©dition</label>
                            <input type="date" id="dateEdition" required>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h2>Information de l'Ã‰tablissement</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="etablissement">Nom de l'Ã‰tablissement</label>
                            <input type="text" id="etablissement" placeholder="Ex: LycÃ©e de Kara" required>
                        </div>
                        <div class="form-group">
                            <label for="codeEtablissement">Code Ã‰tablissement</label>
                            <input type="text" id="codeEtablissement" placeholder="Ex: 000123">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="statut">Statut</label>
                            <select id="statut">
                                <option value="Public">Public</option>
                                <option value="PrivÃ©">PrivÃ©</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ville">Ville</label>
                            <input type="text" id="ville" value="KARA">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h2>Gestion des Ã‰lÃ¨ves</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="nomEleve">Nom</label>
                            <input type="text" id="nomEleve" placeholder="Nom de l'Ã©lÃ¨ve">
                        </div>
                        <div class="form-group">
                            <label for="prenomEleve">PrÃ©nom</label>
                            <input type="text" id="prenomEleve" placeholder="PrÃ©nom de l'Ã©lÃ¨ve">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="matricule">Matricule</label>
                            <input type="text" id="matricule" placeholder="Matricule de l'Ã©lÃ¨ve">
                        </div>
                        <div class="form-group">
                            <label for="effectif">Effectif de la classe</label>
                            <input type="number" id="effectif" min="1" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <button type="button" class="btn btn-success" onclick="ajouterEleve()">
                                <i class="fas fa-plus"></i> Ajouter un Ã©lÃ¨ve
                            </button>
                        </div>
                    </div>

                    <h3>Liste des Ã©lÃ¨ves</h3>
                    <div class="student-list" id="listeEleves">
                        <!-- Les Ã©lÃ¨ves seront ajoutÃ©s ici dynamiquement -->
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <button type="button" class="btn" onclick="chargerMatieresParDefaut()">
                            <i class="fas fa-book"></i> Charger les matiÃ¨res par dÃ©faut
                        </button>
                    </div>
                </div>
            </div>

            <!-- Onglet 2: Saisie des notes -->
            <div class="tab-content">
                <div class="form-section">
                    <h2>Saisie des Notes</h2>
                    
                    <div id="disciplinesContainer">
                        <!-- En-tÃªte du tableau -->
                        <div class="discipline-row" style="font-weight: bold;">
                            <div class="discipline-name">Discipline</div>
                            <div class="discipline-field">Coefficient</div>
                            <div class="discipline-field">Note compo</div>
                            <div class="discipline-field">Moy classe</div>
                            <div class="discipline-field">Moyenne/20</div>
                            <div class="discipline-field">Rang</div>
                            <div class="discipline-field">Enseignant</div>
                            <div style="width: 40px;">Action</div>
                        </div>
                    </div>
                    
                    <button type="button" class="add-btn" id="addDiscipline">
                        <i class="fas fa-plus"></i> Ajouter une discipline
                    </button>
                </div>

                <div class="form-section">
                    <h2>Saisie pour tous les Ã©lÃ¨ves</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="eleveSelect">SÃ©lectionner un Ã©lÃ¨ve</label>
                            <select id="eleveSelect" onchange="chargerNotesEleve()">
                                <option value="">SÃ©lectionner un Ã©lÃ¨ve</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <button type="button" class="btn btn-info" onclick="appliquerNotesClasse()">
                                <i class="fas fa-users"></i> Appliquer Ã  toute la classe
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Onglet 3: RÃ©sultats -->
            <div class="tab-content">
                <div class="form-section">
                    <h2>RÃ©sultats de la Classe</h2>
                    
                    <div class="results-section">
                        <h3>Statistiques de la classe</h3>
                        <div class="results-grid">
                            <div class="result-item">
                                <label>Moyenne de la classe</label>
                                <div class="result-value" id="moyenneClasse">0.00</div>
                            </div>
                            <div class="result-item">
                                <label>Moyenne la plus Ã©levÃ©e</label>
                                <div class="result-value" id="moyenneMax">0.00</div>
                            </div>
                            <div class="result-item">
                                <label>Moyenne la plus basse</label>
                                <div class="result-value" id="moyenneMin">0.00</div>
                            </div>
                            <div class="result-item">
                                <label>Nombre d'Ã©lÃ¨ves</label>
                                <div class="result-value" id="nbEleves">0</div>
                            </div>
                        </div>
                    </div>

                    <h3>Classement des Ã©lÃ¨ves</h3>
                    <table id="tableauClassement">
                        <thead>
                            <tr>
                                <th>Rang</th>
                                <th>Nom et PrÃ©nom</th>
                                <th>Moyenne</th>
                                <th>Mention</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Le classement sera gÃ©nÃ©rÃ© ici -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="actions">
                <button type="button" class="btn btn-success" id="saveBtn">
                    <i class="fas fa-save"></i> Enregistrer la classe
                </button>
                <button type="button" class="btn btn-info" id="calculateBtn">
                    <i class="fas fa-calculator"></i> Calculer les rÃ©sultats
                </button>
                <button type="button" class="btn" id="exportBtn">
                    <i class="fas fa-download"></i> Exporter en JSON
                </button>
                <button type="reset" class="btn btn-secondary">
                    <i class="fas fa-times"></i> RÃ©initialiser
                </button>
            </div>
        </form>

        <footer>
            <p>Direction RÃ©gionale de l'Education - Kara &copy; 2023</p>
            <p>SystÃ¨me de Gestion des Bulletins Scolaires</p>
        </footer>
    </div>

    <script>
        // DonnÃ©es de l'application
        let classeData = {
            informations: {},
            eleves: [],
            matieres: [],
            notes: {}
        };

        // Base de donnÃ©es des matiÃ¨res par niveau et sÃ©rie
        const matieresParNiveau = {
            college: {
                "6e": [
                    { nom: "FranÃ§ais", coef: 3, type: "lettres" },
                    { nom: "MathÃ©matiques", coef: 3, type: "sciences" },
                    { nom: "Histoire-GÃ©ographie", coef: 2, type: "lettres" },
                    { nom: "SVT", coef: 2, type: "sciences" },
                    { nom: "Physique-Chimie", coef: 2, type: "sciences" },
                    { nom: "Anglais", coef: 2, type: "lettres" },
                    { nom: "EPS", coef: 1, type: "autres" }
                ],
                "5e": [
                    { nom: "FranÃ§ais", coef: 3, type: "lettres" },
                    { nom: "MathÃ©matiques", coef: 3, type: "sciences" },
                    { nom: "Histoire-GÃ©ographie", coef: 2, type: "lettres" },
                    { nom: "SVT", coef: 2, type: "sciences" },
                    { nom: "Physique-Chimie", coef: 2, type: "sciences" },
                    { nom: "Anglais", coef: 2, type: "lettres" },
                    { nom: "Espagnol", coef: 1, type: "lettres" },
                    { nom: "EPS", coef: 1, type: "autres" }
                ],
                "4e": [
                    { nom: "FranÃ§ais", coef: 3, type: "lettres" },
                    { nom: "MathÃ©matiques", coef: 3, type: "sciences" },
                    { nom: "Histoire-GÃ©ographie", coef: 2, type: "lettres" },
                    { nom: "SVT", coef: 2, type: "sciences" },
                    { nom: "Physique-Chimie", coef: 2, type: "sciences" },
                    { nom: "Anglais", coef: 2, type: "lettres" },
                    { nom: "Espagnol", coef: 1, type: "lettres" },
                    { nom: "EPS", coef: 1, type: "autres" }
                ],
                "3e": [
                    { nom: "FranÃ§ais", coef: 3, type: "lettres" },
                    { nom: "MathÃ©matiques", coef: 3, type: "sciences" },
                    { nom: "Histoire-GÃ©ographie", coef: 2, type: "lettres" },
                    { nom: "SVT", coef: 2, type: "sciences" },
                    { nom: "Physique-Chimie", coef: 2, type: "sciences" },
                    { nom: "Anglais", coef: 2, type: "lettres" },
                    { nom: "Espagnol", coef: 1, type: "lettres" },
                    { nom: "EPS", coef: 1, type: "autres" }
                ]
            },
            lycee: {
                "2nd": {
                    "default": [
                        { nom: "FranÃ§ais", coef: 3, type: "lettres" },
                        { nom: "MathÃ©matiques", coef: 3, type: "sciences" },
                        { nom: "Histoire-GÃ©ographie", coef: 2, type: "lettres" },
                        { nom: "SVT", coef: 2, type: "sciences" },
                        { nom: "Physique-Chimie", coef: 2, type: "sciences" },
                        { nom: "Anglais", coef: 2, type: "lettres" },
                        { nom: "Espagnol", coef: 1, type: "lettres" },
                        { nom: "EPS", coef: 1, type: "autres" },
                        { nom: "Philosophie", coef: 1, type: "lettres" }
                    ]
                },
                "1ere": {
                    "A": [
                        { nom: "FranÃ§ais", coef: 4, type: "lettres" },
                        { nom: "Philosophie", coef: 3, type: "lettres" },
                        { nom: "Histoire-GÃ©ographie", coef: 3, type: "lettres" },
                        { nom: "Anglais", coef: 2, type: "lettres" },
                        { nom: "Espagnol", coef: 2, type: "lettres" },
                        { nom: "MathÃ©matiques", coef: 2, type: "sciences" },
                        { nom: "SVT", coef: 2, type: "sciences" },
                        { nom: "EPS", coef: 1, type: "autres" }
                    ],
                    "C": [
                        { nom: "MathÃ©matiques", coef: 5, type: "sciences" },
                        { nom: "Physique-Chimie", coef: 4, type: "sciences" },
                        { nom: "FranÃ§ais", coef: 3, type: "lettres" },
                        { nom: "Philosophie", coef: 2, type: "lettres" },
                        { nom: "Anglais", coef: 2, type: "lettres" },
                        { nom: "SVT", coef: 2, type: "sciences" },
                        { nom: "EPS", coef: 1, type: "autres" }
                    ],
                    "D": [
                        { nom: "MathÃ©matiques", coef: 4, type: "sciences" },
                        { nom: "SVT", coef: 4, type: "sciences" },
                        { nom: "Physique-Chimie", coef: 3, type: "sciences" },
                        { nom: "FranÃ§ais", coef: 3, type: "lettres" },
                        { nom: "Philosophie", coef: 2, type: "lettres" },
                        { nom: "Anglais", coef: 2, type: "lettres" },
                        { nom: "EPS", coef: 1, type: "autres" }
                    ],
                    "E": [
                        { nom: "MathÃ©matiques", coef: 5, type: "sciences" },
                        { nom: "Physique-Chimie", coef: 4, type: "sciences" },
                        { nom: "FranÃ§ais", coef: 3, type: "lettres" },
                        { nom: "Philosophie", coef: 2, type: "lettres" },
                        { nom: "Anglais", coef: 2, type: "lettres" },
                        { nom: "EPS", coef: 1, type: "autres" }
                    ]
                },
                "tle": {
                    "A": [
                        { nom: "Philosophie", coef: 4, type: "lettres" },
                        { nom: "FranÃ§ais", coef: 4, type: "lettres" },
                        { nom: "Histoire-GÃ©ographie", coef: 3, type: "lettres" },
                        { nom: "Anglais", coef: 2, type: "lettres" },
                        { nom: "Espagnol", coef: 2, type: "lettres" },
                        { nom: "MathÃ©matiques", coef: 2, type: "sciences" },
                        { nom: "EPS", coef: 1, type: "autres" }
                    ],
                    "C": [
                        { nom: "MathÃ©matiques", coef: 6, type: "sciences" },
                        { nom: "Physique-Chimie", coef: 5, type: "sciences" },
                        { nom: "Philosophie", coef: 3, type: "lettres" },
                        { nom: "FranÃ§ais", coef: 3, type: "lettres" },
                        { nom: "Anglais", coef: 2, type: "lettres" },
                        { nom: "EPS", coef: 1, type: "autres" }
                    ],
                    "D": [
                        { nom: "MathÃ©matiques", coef: 5, type: "sciences" },
                        { nom: "SVT", coef: 5, type: "sciences" },
                        { nom: "Physique-Chimie", coef: 4, type: "sciences" },
                        { nom: "Philosophie", coef: 3, type: "lettres" },
                        { nom: "FranÃ§ais", coef: 3, type: "lettres" },
                        { nom: "Anglais", coef: 2, type: "lettres" },
                        { nom: "EPS", coef: 1, type: "autres" }
                    ],
                    "E": [
                        { nom: "MathÃ©matiques", coef: 6, type: "sciences" },
                        { nom: "Physique-Chimie", coef: 5, type: "sciences" },
                        { nom: "Philosophie", coef: 3, type: "lettres" },
                        { nom: "FranÃ§ais", coef: 3, type: "lettres" },
                        { nom: "Anglais", coef: 2, type: "lettres" },
                        { nom: "EPS", coef: 1, type: "autres" }
                    ]
                }
            }
        };

        document.addEventListener('DOMContentLoaded', function() {
            // DÃ©finir la date du jour comme valeur par dÃ©faut
            const today = new Date().toISOString().substr(0, 10);
            document.getElementById('dateEdition').value = today;
            
            // GÃ©rer l'ajout de nouvelles disciplines
            document.getElementById('addDiscipline').addEventListener('click', addDisciplineRow);
            
            // Ã‰vÃ©nements des boutons
            document.getElementById('saveBtn').addEventListener('click', enregistrerClasse);
            document.getElementById('calculateBtn').addEventListener('click', calculerResultats);
            document.getElementById('exportBtn').addEventListener('click', exporterJSON);
            
            // Charger les donnÃ©es sauvegardÃ©es si elles existent
            chargerDonneesSauvegardees();
        });
        
        function switchTab(index) {
            // Masquer tous les onglets
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // DÃ©sactiver tous les onglets
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Activer l'onglet sÃ©lectionnÃ©
            document.querySelectorAll('.tab-content')[index].classList.add('active');
            document.querySelectorAll('.tab')[index].classList.add('active');
        }
        
        function updateMatieres() {
            const niveau = document.getElementById('niveau').value;
            const classe = document.getElementById('classe').value;
            const serie = document.getElementById('serie').value;
            
            if (niveau && classe) {
                document.getElementById('addDiscipline').style.display = 'none';
            } else {
                document.getElementById('addDiscipline').style.display = 'block';
            }
        }
        
        function ajouterEleve() {
            const nom = document.getElementById('nomEleve').value;
            const prenom = document.getElementById('prenomEleve').value;
            const matricule = document.getElementById('matricule').value;
            
            if (!nom || !prenom) {
                alert("Veuillez saisir au moins le nom et le prÃ©nom de l'Ã©lÃ¨ve.");
                return;
            }
            
            // Ajouter l'Ã©lÃ¨ve Ã  la liste
            const eleve = {
                id: Date.now(), // ID unique
                nom: nom,
                prenom: prenom,
                matricule: matricule
            };
            
            classeData.eleves.push(eleve);
            
            // Mettre Ã  jour l'affichage
            afficherListeEleves();
            
            // Mettre Ã  jour le sÃ©lecteur d'Ã©lÃ¨ves
            mettreAJourSelectEleves();
            
            // RÃ©initialiser le formulaire
            document.getElementById('nomEleve').value = '';
            document.getElementById('prenomEleve').value = '';
            document.getElementById('matricule').value = '';
        }
        
        function afficherListeEleves() {
            const liste = document.getElementById('listeEleves');
            liste.innerHTML = '';
            
            classeData.eleves.forEach(eleve => {
                const div = document.createElement('div');
                div.className = 'student-item';
                div.innerHTML = `
                    <div class="student-info">
                        <span>${eleve.nom} ${eleve.prenom}</span>
                        <span>${eleve.matricule ? 'Matricule: ' + eleve.matricule : ''}</span>
                    </div>
                    <div class="student-actions">
                        <button class="btn btn-sm btn-danger" onclick="supprimerEleve(${eleve.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                liste.appendChild(div);
            });
            
            // Mettre Ã  jour le compteur d'Ã©lÃ¨ves
            document.getElementById('effectif').value = classeData.eleves.length;
            document.getElementById('nbEleves').textContent = classeData.eleves.length;
        }
        
        function supprimerEleve(id) {
            if (confirm("Voulez-vous vraiment supprimer cet Ã©lÃ¨ve ?")) {
                classeData.eleves = classeData.eleves.filter(eleve => eleve.id !== id);
                afficherListeEleves();
                mettreAJourSelectEleves();
            }
        }
        
        function mettreAJourSelectEleves() {
            const select = document.getElementById('eleveSelect');
            select.innerHTML = '<option value="">SÃ©lectionner un Ã©lÃ¨ve</option>';
            
            classeData.eleves.forEach(eleve => {
                const option = document.createElement('option');
                option.value = eleve.id;
                option.textContent = `${eleve.nom} ${eleve.prenom}`;
                select.appendChild(option);
            });
        }
        
        function chargerMatieresParDefaut() {
            const niveau = document.getElementById('niveau').value;
            const classe = document.getElementById('classe').value;
            const serie = document.getElementById('serie').value;
            
            if (!niveau || !classe) {
                alert("Veuillez d'abord sÃ©lectionner le niveau et la classe.");
                return;
            }
            
            // Vider le conteneur des disciplines (sauf l'en-tÃªte)
            const container = document.getElementById('disciplinesContainer');
            while (container.children.length > 1) {
                container.removeChild(container.lastChild);
            }
            
            let matieres = [];
            
            if (niveau === 'college') {
                matieres = matieresParNiveau.college[classe] || [];
            } else if (niveau === 'lycee') {
                if (classe === '2nd') {
                    matieres = matieresParNiveau.lycee[classe].default || [];
                } else {
                    matieres = matieresParNiveau.lycee[classe][serie] || [];
                }
            }
            
            // Ajouter les matiÃ¨res au formulaire
            matieres.forEach(matiere => {
                addDisciplineRow(matiere.nom, matiere.coef, matiere.type);
            });
            
            // Sauvegarder les matiÃ¨res dans les donnÃ©es de la classe
            classeData.matieres = matieres;
        }
        
        function addDisciplineRow(nom = '', coef = 1, type = 'autres') {
            const container = document.getElementById('disciplinesContainer');
            const row = document.createElement('div');
            row.className = 'discipline-row';
            row.innerHTML = `
                <div class="discipline-name">
                    <input type="text" value="${nom}" placeholder="Nom de la discipline" class="nom-discipline">
                </div>
                <div class="discipline-field">
                    <input type="number" min="1" value="${coef}" class="coef-input">
                </div>
                <div class="discipline-field">
                    <input type="number" step="0.01" min="0" max="20" placeholder="Note compo" class="note-compo">
                </div>
                <div class="discipline-field">
                    <input type="number" step="0.01" min="0" max="20" placeholder="Moy classe" class="moy-classe">
                </div>
                <div class="discipline-field">
                    <input type="number" step="0.01" min="0" max="20" placeholder="Moy/20" class="moy-eleve">
                </div>
                <div class="discipline-field">
                    <input type="text" placeholder="Rang" class="rang-input">
                </div>
                <div class="discipline-field">
                    <input type="text" placeholder="Enseignant" class="enseignant-input">
                </div>
                <div>
                    <button type="button" class="remove-btn">Ã—</button>
                </div>
            `;
            
            row.querySelector('.remove-btn').addEventListener('click', function() {
                container.removeChild(row);
            });
            
            container.appendChild(row);
        }
        
        function enregistrerClasse() {
            // RÃ©cupÃ©rer les informations de base
            classeData.informations = {
                inspection: document.getElementById('inspection').value,
                direction: document.getElementById('direction').value,
                anneeScolaire: document.getElementById('anneeScolaire').value,
                periode: document.getElementById('periode').value,
                dateEdition: document.getElementById('dateEdition').value,
                etablissement: document.getElementById('etablissement').value,
                codeEtablissement: document.getElementById('codeEtablissement').value,
                statut: document.getElementById('statut').value,
                ville: document.getElementById('ville').value,
                niveau: document.getElementById('niveau').value,
                classe: document.getElementById('classe').value,
                serie: document.getElementById('serie').value,
                effectif: document.getElementById('effectif').value
            };
            
            // RÃ©cupÃ©rer les matiÃ¨res
            const matieres = [];
            const rows = document.querySelectorAll('.discipline-row');
            
            rows.forEach((row, index) => {
                if (index > 0) { // Ignorer l'en-tÃªte
                    const nom = row.querySelector('.nom-discipline').value;
                    const coef = parseFloat(row.querySelector('.coef-input').value) || 0;
                    const noteCompo = parseFloat(row.querySelector('.note-compo').value) || 0;
                    const moyClasse = parseFloat(row.querySelector('.moy-classe').value) || 0;
                    const moyEleve = parseFloat(row.querySelector('.moy-eleve').value) || 0;
                    const rang = row.querySelector('.rang-input').value;
                    const enseignant = row.querySelector('.enseignant-input').value;
                    
                    if (nom) {
                        matieres.push({
                            nom: nom,
                            coef: coef,
                            noteCompo: noteCompo,
                            moyClasse: moyClasse,
                            moyEleve: moyEleve,
                            rang: rang,
                            enseignant: enseignant
                        });
                    }
                }
            });
            
            classeData.matieres = matieres;
            
            // Enregistrer dans le localStorage
            localStorage.setItem('classeData', JSON.stringify(classeData));
            
            alert('DonnÃ©es enregistrÃ©es avec succÃ¨s !');
        }
        
        function chargerDonneesSauvegardees() {
            const savedData = localStorage.getItem('classeData');
            if (savedData) {
                classeData = JSON.parse(savedData);
                
                // Charger les informations de base
                if (classeData.informations) {
                    document.getElementById('inspection').value = classeData.informations.inspection || '';
                    document.getElementById('direction').value = classeData.informations.direction || '';
                    document.getElementById('anneeScolaire').value = classeData.informations.anneeScolaire || '';
                    document.getElementById('periode').value = classeData.informations.periode || '';
                    document.getElementById('dateEdition').value = classeData.informations.dateEdition || '';
                    document.getElementById('etablissement').value = classeData.informations.etablissement || '';
                    document.getElementById('codeEtablissement').value = classeData.informations.codeEtablissement || '';
                    document.getElementById('statut').value = classeData.informations.statut || '';
                    document.getElementById('ville').value = classeData.informations.ville || '';
                    document.getElementById('niveau').value = classeData.informations.niveau || '';
                    document.getElementById('classe').value = classeData.informations.classe || '';
                    document.getElementById('serie').value = classeData.informations.serie || '';
                    document.getElementById('effectif').value = classeData.informations.effectif || '';
                }
                
                // Charger les Ã©lÃ¨ves
                if (classeData.eleves && classeData.eleves.length > 0) {
                    afficherListeEleves();
                    mettreAJourSelectEleves();
                }
                
                // Charger les matiÃ¨res
                if (classeData.matieres && classeData.matieres.length > 0) {
                    const container = document.getElementById('disciplinesContainer');
                    while (container.children.length > 1) {
                        container.removeChild(container.lastChild);
                    }
                    
                    classeData.matieres.forEach(matiere => {
                        addDisciplineRow(
                            matiere.nom, 
                            matiere.coef, 
                            matiere.type
                        );
                    });
                }
            }
        }
        
        function calculerResultats() {
            // Calculer les moyennes pour chaque Ã©lÃ¨ve
            classeData.eleves.forEach(eleve => {
                if (classeData.notes[eleve.id]) {
                    let totalPoints = 0;
                    let totalCoef = 0;
                    
                    classeData.notes[eleve.id].forEach(note => {
                        totalPoints += note.moyenne * note.coef;
                        totalCoef += note.coef;
                    });
                    
                    eleve.moyenne = totalCoef > 0 ? (totalPoints / totalCoef).toFixed(2) : 0;
                } else {
                    eleve.moyenne = 0;
                }
            });
            
            // Trier les Ã©lÃ¨ves par moyenne (dÃ©croissant)
            classeData.eleves.sort((a, b) => b.moyenne - a.moyenne);
            
            // Attribuer les rangs
            classeData.eleves.forEach((eleve, index) => {
                eleve.rang = index + 1;
                
                // DÃ©terminer la mention
                if (eleve.moyenne >= 16) {
                    eleve.mention = "Excellent";
                } else if (eleve.moyenne >= 14) {
                    eleve.mention = "TrÃ¨s Bien";
                } else if (eleve.moyenne >= 12) {
                    eleve.mention = "Bien";
                } else if (eleve.moyenne >= 10) {
                    eleve.mention = "Assez Bien";
                } else if (eleve.moyenne >= 8) {
                    eleve.mention = "Passable";
                } else {
                    eleve.mention = "Insuffisant";
                }
            });
            
            // Calculer les statistiques de la classe
            let moyenneClasse = 0;
            let moyenneMax = 0;
            let moyenneMin = 20;
            
            if (classeData.eleves.length > 0) {
                let totalMoyennes = 0;
                
                classeData.eleves.forEach(eleve => {
                    totalMoyennes += parseFloat(eleve.moyenne);
                    if (eleve.moyenne > moyenneMax) moyenneMax = eleve.moyenne;
                    if (eleve.moyenne < moyenneMin) moyenneMin = eleve.moyenne;
                });
                
                moyenneClasse = (totalMoyennes / classeData.eleves.length).toFixed(2);
            }
            
            // Afficher les rÃ©sultats
            document.getElementById('moyenneClasse').textContent = moyenneClasse;
            document.getElementById('moyenneMax').textContent = moyenneMax;
            document.getElementById('moyenneMin').textContent = moyenneMin;
            document.getElementById('nbEleves').textContent = classeData.eleves.length;
            
            // Afficher le classement
            const tbody = document.querySelector('#tableauClassement tbody');
            tbody.innerHTML = '';
            
            classeData.eleves.forEach(eleve => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${eleve.rang}</td>
                    <td>${eleve.nom} ${eleve.prenom}</td>
                    <td>${eleve.moyenne}</td>
                    <td>${eleve.mention}</td>
                `;
                tbody.appendChild(tr);
            });
            
            // Passer Ã  l'onglet des rÃ©sultats
            switchTab(2);
        }
        
        function exporterJSON() {
            // PrÃ©parer les donnÃ©es Ã  exporter
            const dataToExport = {
                informations: classeData.informations,
                eleves: classeData.eleves,
                matieres: classeData.matieres,
                notes: classeData.notes
            };
            
            // Convertir en JSON
            const jsonData = JSON.stringify(dataToExport, null, 2);
            
            // CrÃ©er un blob et un lien de tÃ©lÃ©chargement
            const blob = new Blob([jsonData], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `classe_${classeData.informations.classe}_${classeData.informations.periode}.json`;
            document.body.appendChild(a);
            a.click();
            
            // Nettoyer
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
        }
        
        function chargerNotesEleve() {
            const eleveId = document.getElementById('eleveSelect').value;
            // ImplÃ©menter le chargement des notes de l'Ã©lÃ¨ve sÃ©lectionnÃ©
        }
        
        function appliquerNotesClasse() {
            // ImplÃ©menter l'application des notes Ã  toute la classe
        }
    </script>
</body>
</html>
